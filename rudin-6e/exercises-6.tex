%   Principles of Mathematical Analysis Chapter 6 Solutions
%   Jasper Ty
%
%   to compile:
%       pdflatex [filename]
\documentclass{article}

% + preamble
\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[margin=0.5in]{geometry}

\newenvironment{myboxed}{\noindent\begin{tabular}{|p{.975\textwidth}|}\hline \\}{\\\\\hline\end{tabular}}
\newenvironment{mytitle}{\noindent\large\begin{flushright}}{\end{flushright}\normalsize}

\newcounter{Question}
\newenvironment{Question} 
{\bigskip\begin{myboxed}\refstepcounter{Question}\par\noindent\textbf{Q\theQuestion.}}
{\end{myboxed}\bigskip}
\newenvironment{Answer} {\par\noindent\textbf{A:}} {}
% - preamble

\begin{document}

\begin{mytitle}
    Principles of Mathematical Analysis \\
    Chapter 6 \\
    \normalsize Jasper Ty
\end{mytitle}

\noindent
\footnotesize 
(Note: no guarantee of correctness. Just an undergrad writing their answers down and archiving because notebooks have become unwieldy.)
\normalsize


\begin{Question}
    Suppose $\alpha$ increases on $[a, b]$, $a \leq x_0 \leq b$, $\alpha$ is continuous at $x_0$, $f(x_0) = 1$, and $f(x) = 0$ if $x \neq x_0$. Prove that $f \in \mathscr{R}(\alpha)$ and that $\int f d\alpha = 0$.
\end{Question}
\begin{Answer}
    \textsc{Idea}

    $x_0$ may be covered with an interval of arbitrarily small width, and this segment will have an arbitrarily small weight in the sum due to $\alpha$'s continuity at $x_0$.

    \textsc{Proof that $f \in \mathscr{R}(\alpha)$:}

    Let $\varepsilon > 0$.

    Since $\alpha$ is continuous at $x_0$, choose $\delta$ such that $|x-x_0| \leq 2\delta$ implies $|\alpha(x) - \alpha(x_0)| \leq \varepsilon$. 

    Then let $P = [a, x_0-\delta, x_0 + \delta, b]$. Then
    \begin{align*}
        U(P,f,\alpha) &= \sum_{i=0}^n M_i \Delta\alpha_i \\
        &= M_0 \Delta\alpha_0 + M_1 \Delta\alpha_1 + M_2 \Delta\alpha_2 
    \end{align*}
    Since $f(x) = 0$ on $[a, x_0 - \delta]$ and $[x_0 + \delta, b]$, $M_0 = 0$ and $M_2 = 0$. Moreover, $M_1 = 1$ 
    \[U(P,f,\alpha) = 0 + 1 \cdot \Delta\alpha_1 + 0 \Delta = \alpha_1\]
    As for $L$, the following holds for any partition at all, as any nonempty interval must contain a point that is not $x_0$
    \[L(P,f,\alpha) = 0\]
    So
    \[
        U(P,f,\alpha) - L(P, f, \alpha) = \Delta\alpha_1
        = \alpha(x+\delta) - \alpha(x-\delta) < \varepsilon\]
    Then $f \in \mathscr{R}(\alpha)$.

    \textsc{Proof that $\int fd\alpha = 0$:}

    Since $L(P,f,\alpha) = 0$ for all $P$, 
    \[\underline{\int}fd\alpha = 0\]
    Which lets us conclude 
    \[\int fd\alpha = 0\]
\end{Answer}


\begin{Question}
    Suppose $f \geq 0$, $f$ is continuous on $[a,b]$, and $\int_a^b f(x)dx = 0$. Prove that $f(x) = 0$ for all $x \in [a, b]$. (Compare this with Exercise 1.)
\end{Question}
\begin{Answer}
    \textsc{Idea}

    We show a contradiction that a ``bump'' of nonzero area must exist if $f$ is not identically zero, hence the integral must be nonzero.

    \textsc{Proof}
    
    Choose any arbitrary point $q$ in $[a, b]$. Suppose $f(q) > 0$. Let $m$ be a number such that $0 < m < f(q)$, and use the continuity of $f$ to create an interval $[s, t]$ containing $q$ such that $x \in [s, t]$ implies $f(x) \geq m$. 

    By additivity of the integral,
    \[\int_a^b f dx = \int_a^s f dx + \int_s^t f dx + \int_t^b f dx\]
    Hence
    \[\int_a^b f dx \geq \int_s^t f dx \]
    But $\int_s^t f dx \geq m(t-s) > 0$, so
    \[\int_a^b f dx > 0\]
    A contradiction to the assertion that $\int_a^b fdx = 0$
\end{Answer}


\newpage
\begin{Question}
    Define three functions $\beta_1$, $\beta_2$, $\beta_3$ as follows: $\beta_j(x) = 0$ if $x < 0$, $\beta_j(x) = 1$ if $x > 0$ for $j = 1, 2, 3$; and $\beta_1(0) = 0$, $\beta_2(0) = 1$, $\beta_3(0) = \frac{1}{2}$. Let $f$ be a bounded function on $[-1, 1]$.
    \begin{itemize}
        \item [(a)] Prove that $f \in \mathscr{R}(\beta_1)$ if and only if $f(0^+) = f(0)$ and that then
        \[\int f d\beta_1 = f(0)\]
        \item [(b)] State and prove a similar result for $\beta_2$
        \item [(c)] Prove that $f \in \mathscr{R}(\beta_3)$ if and only if $f$ is continuous at $0$
        \item [(d)] If $f$ is continuous at $0$ prove that
        \[\int f d\beta_1 = \int f d\beta_2 = \int f d\beta_3 = f(0)\]
    \end{itemize}
\end{Question}
\begin{Answer}
        \textsc{Idea}

        With $\beta_i$, the only intervals with non-zero weight in any partition will be those which contain $0$. Moreover, these segments will have fixed weights due to our definitions of $\beta_i$. Then, bounds on the variation of the upper and lower Riemann sums automatically pass through as bounds on $f$ in the segment itself.

        Hence we can convert convergence of Riemann sums into convergence of $f$.
    \begin{itemize}
        \item [(a)]
        \textsc{Proof that $f \in \mathscr{R}(\beta_1)$ implies $f(0+) = f(0)$}

        Let $f \in \mathscr{R}(\beta_1)$. Let $\varepsilon > 0$. Choose a partition $P$ such that $0 \in P$, and
        \[U(P, f, \beta_1) - L(P, f, \beta_1) < \varepsilon\]
        The only nonzero term in either of the sums $U(P,f,\beta_1)$ or $L(P,f,\beta_1)$ comes from the segment containing $x = 0$ as a left endpoint. Let this segment be $[0, x_i]$. Then 
        \[U(P, f, \beta_1) = M_i \cdot \Delta x_i = M_i \cdot (\beta(x_i) - \beta(0)) = M_i \cdot 1 = M_i\]
        \[L(P, f, \beta_1) = M_i \cdot \Delta x_i = m_i \cdot (\beta(x_i) - \beta(0)) = m_i \cdot 1 = m_i\]
        So $U(P, f, \beta_1) - L(P, f, \beta_1) = M_i - m_i < \varepsilon$. This tells us that on $[0, x_i]$, $f$ stays within $\varepsilon$ of $f(0)$. Since $\varepsilon$ was arbitrary, we conclude that $f(0+) = f(0)$
        
        \textsc{Proof that $f(0+) = f(0)$ implies $f \in \mathscr{R}(\beta_1)$}

        Let $f(0+) = f(0)$. Let $\varepsilon > 0$ Choose $\delta$ such that $x \in (0, \delta)$ implies $f(x) \in (f(0) - \varepsilon, f(0) + \varepsilon)$. Let $P$ be the partition $\{a, 0, \delta, b\}$. Then for the same reasons as above,
        \[U(P, f, \beta_1) - L(P, f, \beta_1) < \varepsilon\]
        So $f \in \mathscr{R}(\beta_1)$.

        \textsc{Proof that $\int fd\beta_1 = 0$}

        By Theorem 6.7(b), letting $t_i = 0$, we have that
        \[\left|f(0) - \int f d\beta_1 \right| < \varepsilon\]
        Hence we conclude that
        \[\int f d\beta_1 = f(0)\]
        \item [(b)] 
            \textsc{Statement}

            $f \in \mathscr{R}(\beta_1)$ if and only if $f(0-) = f(0)$, and if it exists,

        \[\int f d\beta_1 = f(0)\]

        \textsc{Proof}

        Extremely similar as before, but with $[x_{i-1}, 0]$ instead of $[0, x_i]$

        \item [(c)]         
            \textsc{Proof that $f \in \mathscr{R}(\beta_3)$ implies $f$ is continuous at $0$}

            Let $f \in \mathscr{R}(\beta_3)$. Let $\varepsilon > 0$. Let $P$ be a partition that such that $0 \in P$ and $U(P, f, \beta_3) - L(P, f, \beta_3) < \varepsilon$

            Then, consider the intervals $[x_{i-1}, 0]$, $[0, x_i]$. We have that
            \[\beta_3(0) - \beta_3(x_{i-1}) = \frac{1}{2}\]
            \[\beta_3(x_i) - \beta_3(0) = \frac{1}{2}\]
            Then 
            \[U(P, f, \beta_3) = \frac{M_i + M_{i-1}}{2}\]
            \[L(P, f, \beta_3) = \frac{m_i + m_{i-1}}{2}\]
            Let $M = \min \{ M_i, M_{i-1} \}$ and $m = \max \{ m_i, m_{i-1}\}$, then
            \[U(P, f, \beta_3) \geq M \]
            \[L(P, f, \beta_3) \leq m\]
            Then 
            \[M - m \leq U(P, f, \beta_3) - L(P, f, \beta_3) < \varepsilon\]
            Hence $f(x)$ is within $\varepsilon$ of $f(0)$ if $f(x)$ is in $[x_{i-1}, x_i]$. Hence $f$ is continuous.

            \textsc{Proof that $f$ continuous at $0$ implies $f \in \mathscr{R}(\beta_3)$}

            Let $f$ be continuous at $0$. Let $\varepsilon > 0$. Choose $\delta$ such that $|x| \leq 2\delta$ implies $|f(x) - f(0)| \leq \varepsilon/2$ then take the partition $P = \{a, -\delta, \delta, b\}$. Then
        \[U(P, f, \beta_3) - L(P, f, \beta_3) < \varepsilon\]
        Hence $f \in \mathscr{R}(\beta_3)$. Also, with a similar argument as in (a), 
        \[\int f d\beta_3 = f(0)\]


        \item [(d)] 
            $f$ being continuous at zero is a strong enough condition for all three previous proofs above to apply. Since all of them show equality of the integral with respect to $\beta_i$ and $f(0)$, the result follows.
    \end{itemize}
\end{Answer}


\begin{Question}
    If $f(x) = 0$ for all irrational $x$, $f(x) = 1$ for all rational $x$, prove that $f \notin \mathscr{R}$ on $[a, b]$ for any $a < b$
\end{Question}
\begin{Answer}
    Let $P$ be a partition. Since $\mathbb{Q}$ is dense in $\mathbb{R}$, for all $x_i$ we can find two rational numbers $p$ and $q$ such that $x_{i-1} < p < q < x_i$. This tells us that $M_i = 1$ for all $x_i$. Furthermore, the number $s = p + (\sqrt{2}/2)(q-p)$ is irrational and between $p$ and $q$. This tells us that $m_i = 1$ for all $x_i$. Hence it must be that
    \[U(P, f) = 1\]
    \[L(P, f) = 0\]
    for any partition $P$. Then $f$ is not Riemann-integrable.
\end{Answer}


\begin{Question}
    Suppose $f$ is a bounded real function on $[a, b]$, and $f^2 \in \mathscr{R}$ on $[a,b]$. Does it follow that $f \in \mathscr{R}$? Does the answer change if we assume that $f^3 \in \mathscr{R}$?
\end{Question}
\begin{Answer}
    No. Consider the function
    \[
        f(x) := \begin{cases}
        1 & x \text{ rational} \\
        -1 & x \text{ irrational} \\
        \end{cases}
    \]
    We have that $(f^2)(x) = 1$, so $\int_a^b f^2 dx = (b-a)$. But $f$ itself is not Riemann-integrable, as the exercise above shows.

    For $f^3$, use Theorem 6.11, which tells us that the composition of continuous functions with integrable functions is integrable. Let $\phi = \sqrt[3]{x}$. Then $\phi \circ (f^3) \in \mathscr{R}$ Since $\phi \circ f^3 = f$, $f \in \mathscr{R}$.
\end{Answer}


\begin{Question}
    Let $P$ be the Cantor set constructed in Sec. 2.44. Let $f$ be a bounded real function on $[0, 1]$ which is continuous at every point outside $P$. Prove that $f \in \mathscr{R}$ on $[0,1]$. \textit{Hint:} $P$ can be covered by finitely many segments whose total length can be made as small as desired. Proceed as in Theorem 6.10.
\end{Question}
\begin{Answer}
    Each set of the sequence that constructs the Cantor set has $2^n$ intervals, each of width $1/3^n$. Let $E_n$ be the $n$th set in the sequence. Cover each interval in $E_n$ with an open interval whose endpoints have a distance of $1.1\cdot(1/3^n)$. Then, the sum of all lengths of each cover will be $1.1 \cdot (2/3)^n$. This also covers the Cantor set itself, since the Cantor set $E$ is a subset of $E_n$ for all $n$. Hence, we have made a cover of the Cantor set with arbitrarily small area.

    Take the endpoints of each interval and construct a partition, and proceed as in Theorem 6.10. 
    This sequence of partitions eventually.
\end{Answer}


\newpage
\begin{Question}
    Suppose $f$ is a real function on $(0, 1]$ and $f \in \mathscr{R}$ on $[c,1]$ for every $c > 0$. Define
    \[\int_0^1 f(x) dx = \lim_{c\to 0} \int_c^1 f(x)dx\]
    if this limit exists (and is finite).
    \begin{itemize}
        \item[(a)] If $f \in \mathscr{R}$ on $[0, 1]$, show that this definition of the integral agrees with the old one.
        \item[(b)] Construct a function $F$ such that the above limit exists, although it fails to exist with $|f|$ in place of $f$
    \end{itemize}
\end{Question}
\begin{Answer}
    \begin{itemize}
        \item[(a)]
            Lemma: If $f \in \mathscr{R}$ on $[a ,b]$, then
            \[\lim_{h \to a} \int_a^h f(x)dx = 0\]
            Proof: Let $|f(x)| \leq M$. Let $\varepsilon > 0$. Choose $\delta = \varepsilon/M$. Then, letting $h \leq \delta$
            \[\left|\int_a^h f(x) dx\right| \leq M((a+h) - a) = Mh \leq M\delta = \varepsilon\]
            Since the $\varepsilon$ was arbitrary, the lemma holds.
            Then, by Theorem 6.12, if $f \in \mathscr{R}$ on $[0, 1]$,
            \[\int_0^1 f(x)dx = \int_0^c f(x)dx + \int_c^1 f(x)dx\]
            Then, taking limits
            \begin{align*}
                \lim_{c \to 0} \int_0^1 f(x)dx &= \lim_{c \to 0}\int_0^c f(x)dx + \lim_{c \to 0}\int_c^1 f(x)dx \\
                \int_0^1 f(x)dx &= 0 + \lim_{c \to 0}\int_c^1 f(x)dx \\
                \int_0^1 f(x)dx &= \lim_{c \to 0}\int_c^1 f(x)dx \\
            \end{align*}
            Hence showing that the definition agrees.
        \item[(b)]
            Let $n = 1, 2, \ldots$. Consider the function (with infinitely many cases)
            \[f(x) = \begin{cases}
                (-1)^{n+1}n+1 & \text{if } \frac{1}{n+1} \leq x < \frac{1}{n}
            \end{cases}\]
            Then the graph of $f$ consists of boxes of width $1/n - 1/(n+1)$ and height $n+1$. The area of each box is then $1/n$. Then as the lower bound of the integral approaches $0$, the integral approximates the alternating sum $S = 1 - 1/2 + 1/3 - 1/4 + \cdots$, which converges to $\ln 2$.
            However, in the case of $|f|$, the integral apporximates the sum $S = 1 + 1/2 + 1/3 + 1/4 + \cdots$, which diverges.
    \end{itemize}
\end{Answer}


\newpage
\begin{Question}
    Suppose $f \in \mathscr{R}$ on $[a, b]$ for every $b > a$ where $a$ is fixed. Define 
    \[\int_a^\infty f(x) dx = \lim_{b \to \infty} \int_a^b f(x) dx\]
    if this limit exists (and is finite). In that case, we say that the integral on the left \textit{converges}. If it also converges after $f$ has been replaced by $|f|$, it is said to converge \textit{absolutely}.
    Assume that $f(x) \geq 0$ and that $f$ decreases monotonically on $[1, \infty)$. Prove that
    \[\int_1^\infty f(x) dx\] 
    converges if and only if
    \[\sum_{n=1}^\infty f(n)\] 
    converges. (This is the so-called ``integral test" for convergence of series.)
\end{Question}
\begin{Answer}
    Suppose $\int_1^\infty f(x) dx$ converges. Then if we show that, for any positive integer $b$,
    \[\sum_{n=1}^b f(n) \leq \int_1^b f(x) dx\]
    we can prove convergence of the sum, as the partial sums form a monotonic sequence ($f$ is non-negative).
    Let $P$ be the partition consisting of the points $0, 1, 2, \ldots, b-1, b$. Then, since $f$ is monotonically decreasing, 
    \[\inf_{x \in [n-1, n]} f(x) = f(n)\]
    Hence 
    \[\sum_{n=1}^b f(n) = L(P, f) \leq \int_1^b f(x) dx \]
    which was the inequality we wanted. Then the sum converges.
    
    Suppose $\int_1^\infty f(x) dx$ converges. Then we make a similar argument, with $U(P, f)$ bounding $\int_1^b f(x) dx$ from above. Take the same partition of $[a, b]$, then 
    \[\sup_{x \in [n, n+1]} f(x) = f(n)\]
    Hence 
    \[U(P, f) = \sum_{n=0}^{b-1} f(n)\]
    Which proves that the integral converges.
\end{Answer}


\begin{Question}
    Show that integration by parts can sometimes be applied to the ``improper" integrals defined in Exercises $7$ and $8$. (State appropriate hypotheses, formulate a theorem, and prove it.) For instance show that

    \[\int_0^\infty \frac{\cos x}{1+x} dx = \int_0^\infty \frac{\sin x}{(1+x)^2}\]
\end{Question}
\end{document}
